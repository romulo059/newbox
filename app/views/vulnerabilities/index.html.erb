<%= react_component 'Menubar' %>

<p id="notice"><%= notice %></p>

<br><br><br>

<h1>Vulnerabilities</h1>

<table class="striped">
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Criticality</th>
      <th>Solution</th>
      <th>Cvss score</th>
      <th>Asset</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @vulnerabilities.each do |vulnerability| %>
      <tr>
        <td><%= vulnerability.name %></td>
        <td><%= vulnerability.description %></td>
        <td><%= vulnerability.criticality %></td>
        <td><%= vulnerability.solution %></td>
        <td><%= vulnerability.cvss_score %></td>
        <td><%= vulnerability.asset.name %></td>
        <td><%= link_to 'Show', vulnerability, class: 'white-text waves-effect waves-light btn-small' %></td>
        <td><%= link_to 'Edit', edit_vulnerability_path(vulnerability), class: 'white-text waves-effect waves-light btn-small' %></td>
        <td><%= link_to 'Destroy', vulnerability, method: :delete, data: { confirm: 'Are you sure?' }, class: 'white-text waves-effect waves-light btn-small' %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<div class="red-text">
<%= link_to 'New Vulnerability', new_vulnerability_path, class: "white-text waves-effect waves-light btn" %>
</div>


<br><br>
<%= pie_chart Vulnerability.group(:criticality).count %>

<%= pie_chart Asset.group(:name).count %>
